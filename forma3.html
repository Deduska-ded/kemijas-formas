<!DOCTYPE html>
<html lang="lv">
<head>
    <meta charset="UTF-8">
    <title>Ķīmijas laboratorijas uzskaites sistēma – 3. forma</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
<div class="page">
    <div class="form-card">
        <div class="top-links">
            <a href="index.html" class="back-link">&lt; Atgriezties uz 1. formu</a>
        </div>

        <h1>Ķīmijas laboratorijas uzskaites sistēma</h1>
        <h2>3. forma – Publiskā informācija par laboratorijas krājumiem</h2>

        <p class="info-text">
            Šī forma paredzēta, lai parādītu skolai publiski pieejamu informāciju par laboratorijas vielām un inventāru.
        </p>

        <!-- Filtra pogas -->
        <div class="nav-row filter-row">
            <button type="button" class="btn primary" id="btn-all">Rādīt visu</button>
            <button type="button" class="btn outline" id="btn-vielas">Rādīt vielas</button>
            <button type="button" class="btn outline" id="btn-inventars">Rādīt inventāru</button>
        </div>

        <div class="table-wrapper">
            <table>
                <thead>
                <tr>
                    <th>ID</th>
                    <th>Nosaukums</th>
                    <th>Tips</th>
                    <th>Apakštips</th>
                    <th>Skaits</th>
                    <th>Stāvoklis</th>
                    <th>Komentāri</th>
                </tr>
                </thead>
                <tbody id="data-body">
                <!-- Šeit JavaScript ieliks datus -->
                </tbody>
            </table>
        </div>

        <div class="nav-row nav-row-bottom">
            <a href="index.html" class="btn outline">Uz 1. formu</a>
            <a href="forma2.html" class="btn primary">Uz 2. formu</a>
        </div>
    </div>
</div>

<!-- JavaScript ar datu ielādi -->
<script>
document.addEventListener('DOMContentLoaded', () => {
    const tbody = document.getElementById('data-body');
    const btnAll = document.getElementById('btn-all');
    const btnVielas = document.getElementById('btn-vielas');
    const btnInventars = document.getElementById('btn-inventars');

    let allItems = [];

    function formatId(prefix, id) {
        const num = String(id).padStart(4, '0');
        return prefix + num;
    }

    function renderTable(items) {
        tbody.innerHTML = '';

        if (!items || items.length === 0) {
            const tr = document.createElement('tr');
            const td = document.createElement('td');
            td.colSpan = 7;
            td.textContent = 'Nav datu, kas atbilst izvēlei.';
            tr.appendChild(td);
            tbody.appendChild(tr);
            return;
        }

        items.forEach(item => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td>${item.idDisplay}</td>
                <td>${item.nosaukums}</td>
                <td>${item.tips || ''}</td>
                <td>${item.apakstips || ''}</td>
                <td>${item.skaits != null ? item.skaits : ''}</td>
                <td>${item.stavoklis || ''}</td>
                <td>${item.komentari || ''}</td>
            `;
            tbody.appendChild(tr);
        });
    }

    Promise.all([
        fetch('inventars.json').then(r => r.json()),
        fetch('vielas.json').then(r => r.json())
    ])
    .then(([inventars, vielas]) => {
        const invItems = inventars.map(obj => ({
            category: 'inventars',
            idDisplay: formatId('I', obj.id),
            nosaukums: obj.nosaukums,
            tips: obj.tips || 'Inventārs',
            apakstips: obj.apakstips || '',
            skaits: obj.skaits,
            stavoklis: '',
            komentari: obj.komentari || ''
        }));

        const vItems = vielas.map(obj => ({
            category: 'viela',
            idDisplay: formatId('V', obj.id),
            nosaukums: obj.nosaukums,
            tips: obj.tips || 'Viela',
            apakstips: obj.apakstips || '',
            skaits: obj.skaits,
            stavoklis: '',
            komentari: obj.komentari || ''
        }));

        allItems = [...invItems, ...vItems];

        // Pēc noklusējuma – rādam visu
        renderTable(allItems);
    })
    .catch(err => {
        console.error('Kļūda ielādējot JSON datnes:', err);
        tbody.innerHTML = '';
        const tr = document.createElement('tr');
        const td = document.createElement('td');
        td.colSpan = 7;
        td.textContent = 'Kļūda ielādējot datus.';
        tr.appendChild(td);
        tbody.appendChild(tr);
    });

    if (btnAll) {
        btnAll.addEventListener('click', () => {
            renderTable(allItems);
        });
    }

    if (btnVielas) {
        btnVielas.addEventListener('click', () => {
            const filtered = allItems.filter(item => item.category === 'viela');
            renderTable(filtered);
        });
    }

    if (btnInventars) {
        btnInventars.addEventListener('click', () => {
            const filtered = allItems.filter(item => item.category === 'inventars');
            renderTable(filtered);
        });
    }
});
</script>

</body>
</html>
